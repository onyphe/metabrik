#!/usr/bin/perl
#
# $Id$
#
use strict;
use warnings;

BEGIN {
   use File::HomeDir;

   my $lib = File::HomeDir->my_home."/perl5/lib/perl5";
   $lib =~ s/\\/\//g; # Converts Windows path

   eval("use lib \"$lib\";");
   if ($@) {
      chomp($@);
      die("[FATAL] meby: unable to load Metabricky libs [$@]\n");
   }
}

use Metabricky::Brick::Core::Context;

my $script = shift;

my $context = Metabricky::Brick::Core::Context->new;
$context->init or return;

$context->load('shell::meby') or return;

if (defined($script)) {
   $context->set('shell::meby', 'load_history_file', 0);
   $context->set('shell::meby', 'load_rc_file', 0);
   $context->run('shell::meby', 'script', $script);
}
else {
   $context->run('shell::meby', 'cmdloop');
}
